<!DOCTYPE html>
<html lang="en" data-decorator="load-ga">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mozilla - Log in</title>
    <link href="../../dist/css/styles.css" type="text/css" inline />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600" rel="stylesheet">
  </head>
  <body>
    <script>
      /* Ugly hack to auto log you in. Only works with LDAP in this case */
      if ( window.location.hostname !== 'localhost' ) {
        var w = window.location.toString();
        if ( w.indexOf('tried_silent_auth=true') === -1 ) {
          document.body.hidden = true ;
          window.location = w.replace('/login?', '/authorize?').replace('?client=', '?client_id=') + '&sso=true&connection=Mozilla-LDAP-Dev&tried_silent_auth=true'
        }
      }
    </script>
    <div class="banner">
      <p>Yay, we are piloting the new login experience. Things might break from time to time. <a href="https://discourse.mozilla.org/t/piloting-the-new-lock/23199" class="banner__button">Read more</a></p>
    </div>
    <div class="card">
      <a href="https://mozilla.org" class="logo"><img alt="Mozilla" src="../images/mozilla.svg" inline /></a>
      <form data-decorator="init-auth set-focus-to-input">
        <legend class="visually-hidden">Log in</legend>
        <div id="initial" data-screen>
          <p>Log in with email or third-party</p>
          <label for="field-email" class="visually-hidden">E-mail address</label>
          <input type="email" id="field-email" placeholder="Email address" data-decorator="continue-with-keyboard" data-continue-with="enter-initial" autocomplete="username" />
          <button type="button" class="button button--full-width" data-handler="enter" id="enter-initial">Enter</button>
          <hr>
          <ul class="login-options list list--plain">
            <li>
              <button class="button button--full-width button--social button--secondary" type="button" data-handler="authorise-github">
                <img inline class="icon" src="../images/github.svg" role="presentation">
                <span>Log in with GitHub</span>
              </button>
            </li>
            <li>
              <button class="button button--full-width button--social button--secondary" type="button" data-handler="authorise-google">
                <img inline  class="icon" src="../images/google.svg" role="presentation">
                <span>Log in with Google</span>
              </button>
            </li>
          </ul>
        </div>
        <div id="ldap" data-screen hidden>
          <p>Welcome</p>
          <label for="field-password" class="visually-hidden">Password</label>
          <input type="password" id="field-password" placeholder="Password" data-decorator="continue-with-keyboard" data-continue-with="authorise-ldap-credentials" autocomplete="current-password" />
          <button type="button" class="button button--full-width" data-handler="authorise-ldap" id="authorise-ldap-credentials">Enter</button>
          <hr>
          <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
        </div>
        <div id="non-ldap" data-screen hidden>
          <ul class="login-options list list--plain">
            <li>
              <button class="button button--full-width button--secondary" type="button" data-handler="send-passwordless-link">Send me an email</button>
            </li>
          </ul>
          <a href="https://wiki.mozilla.org/IAM/Frequently_asked_questions#Q:_Why_do_you_support_email_login_.28.22passwordless.22.29_if_it.27s_less_safe_than_other_methods.3F" class="button button--text-only button--unpadded">Why an email?</a>
          <hr>
          <ul class="login-options list list--plain">
            <li>
              <button class="button button--full-width button--social button--secondary" type="button" data-handler="authorise-github">
                <img inline class="icon" src="../images/github.svg" role="presentation">
                <span>Log in with GitHub</span>
              </button>
            </li>
            <li>
              <button class="button button--full-width button--social button--secondary" type="button" data-handler="authorise-google">
                <img inline  class="icon" src="../images/google.svg" role="presentation">
                <span>Log in with Google</span>
              </button>
            </li>
          </ul>
          <hr>
          <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
        </div>
        <div id="passwordless-success" data-screen hidden>
          <h2 class="card__heading card__heading--success"><img src="../images/envelope.svg" class="card__heading-icon" inline /> <span>Success</span></h2>
          <p>Email sent to <span id="passwordless-success-email-address"></span>, your login link will expire in 15 minutes.</p>
          <hr>
          <button id="back" type="button" class="button button--text-only card__back  button--unpadded" data-handler="go-to-initial-page">Need to send that to a different email?</button>
        </div>
        <div id="error-password" data-screen hidden>
          <h2 class="card__heading card__heading--error" id="error-message-ldap"><img src="../images/circled-x.svg" class="card__heading-icon" inline /> <span>Error</span></h2>
          <p>Please attempt again or contact the Help Desk for assistance.</p>
          <label for="field-password-try-2" class="visually-hidden">Password</label>
          <input type="password" id="field-password-try-2" placeholder="Password" data-decorator="continue-with-keyboard" data-continue-with="authorise-ldap-credentials-try-2" />
          <button type="button" class="button button--full-width" data-handler="authorise-ldap" id="authorise-ldap-credentials-try-2">Enter</button>
          <hr>
          <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
        </div>
        <div id="error-passwordless" data-screen hidden>
          <h2 class="card__heading card__heading--error" id="error-message-passwordless"><img src="../images/circled-x.svg" class="card__heading-icon" inline /> <span>Error</span></h2>
          <p>We cannot send an email to this address</p>
          <button type="button" class="button button--text-only card__back  button--unpadded" data-handler="go-to-initial-page">Try again</button>
          <hr>
          <button type="button" class="button button--text-only card__back button--unpadded" data-handler="go-to-initial-page">Need to log in with a different account?</button>
        </div>
        <div id="loading" class="loading" data-screen hidden>
          <p class="visually-hidden ">Loadingâ€¦</p>
          <img src="../images/loading.svg" class="loading__spinner" inline />
        </div>
      </form>
      <ul class="legal-links list list--plain">
        <li><a href="https://www.mozilla.org/en-US/about/legal/">Legal</a></li>
        <li><a href="https://www.mozilla.org/en-US/privacy/websites/">Privacy</a></li>
        <li><a href="https://discourse.mozilla.org/c/iam">Need help?</a></li>
      </ul>
    </div>
    <script src="../../dist/js/main.js" inline></script>
  </body>
</html>
